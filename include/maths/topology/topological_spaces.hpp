#ifndef MATHS_TOPOLOGY_TOPOLOGICAL_SPACES_HPP
#define MATHS_TOPOLOGY_TOPOLOGICAL_SPACES_HPP

#include <vector>
#include <set>
#include <functional>
#include <algorithm>
#include <string>
#include <stdexcept>

/**
 * @file topological_spaces.hpp
 * @brief Topological spaces, weak topologies, and semicontinuity
 *
 * Implements:
 * - General topological spaces
 * - Weak topologies
 * - Separation axioms (T0, T1, T2/Hausdorff, etc.)
 * - Semicontinuous functions
 * - Baire spaces
 */

namespace maths::topology {

/**
 * @class TopologicalSpaceProperties
 * @brief Properties and theorems about topological spaces
 */
class TopologicalSpaceProperties {
public:
    /**
     * @brief Definition of topological space
     */
    static std::string definition() {
        return "Topological Space:\n"
               "\n"
               "A topological space is a pair (X, œÑ) where X is a set\n"
               "and œÑ is a collection of subsets of X (called open sets) satisfying:\n"
               "\n"
               "1. ‚àÖ, X ‚àà œÑ\n"
               "2. Arbitrary unions of sets in œÑ are in œÑ\n"
               "3. Finite intersections of sets in œÑ are in œÑ\n"
               "\n"
               "The collection œÑ is called a topology on X.\n"
               "\n"
               "Examples:\n"
               "- Discrete topology: œÑ = P(X) (all subsets)\n"
               "- Indiscrete/trivial topology: œÑ = {‚àÖ, X}\n"
               "- Metric topology: œÑ generated by open balls";
    }

    /**
     * @brief Separation axioms
     */
    static std::string separationAxioms() {
        return "Separation Axioms:\n"
               "\n"
               "T‚ÇÄ (Kolmogorov): For distinct x, y, ‚àÉ open set\n"
               "  containing one but not the other\n"
               "\n"
               "T‚ÇÅ (Fr√©chet): For distinct x, y, ‚àÉ open sets U, V\n"
               "  with x ‚àà U, y ‚àâ U and y ‚àà V, x ‚àâ V\n"
               "  Equivalently: singletons {x} are closed\n"
               "\n"
               "T‚ÇÇ (Hausdorff): For distinct x, y, ‚àÉ disjoint open sets\n"
               "  U, V with x ‚àà U, y ‚àà V\n"
               "  (can separate points by open neighborhoods)\n"
               "\n"
               "T‚ÇÉ (Regular): T‚ÇÄ + for closed F and x ‚àâ F,\n"
               "  ‚àÉ disjoint open sets separating x and F\n"
               "\n"
               "T‚ÇÉ¬Ω (Tychonoff/Completely regular): T‚ÇÄ + for closed F\n"
               "  and x ‚àâ F, ‚àÉ continuous f: X ‚Üí [0,1]\n"
               "  with f(x) = 0, f(F) = {1}\n"
               "\n"
               "T‚ÇÑ (Normal): T‚ÇÅ + for disjoint closed F, G,\n"
               "  ‚àÉ disjoint open sets separating F and G\n"
               "\n"
               "Hierarchy: T‚ÇÑ ‚áí T‚ÇÉ¬Ω ‚áí T‚ÇÉ ‚áí T‚ÇÇ ‚áí T‚ÇÅ ‚áí T‚ÇÄ\n"
               "\n"
               "Note: All metric spaces are T‚ÇÑ (normal).";
    }

    /**
     * @brief Connectedness
     */
    static std::string connectedness() {
        return "Connectedness:\n"
               "\n"
               "X is connected if it cannot be written as X = U ‚à™ V\n"
               "where U, V are non-empty, disjoint, and open.\n"
               "\n"
               "Equivalent definitions:\n"
               "1. No non-trivial clopen sets (sets both open and closed)\n"
               "2. Every continuous f: X ‚Üí {0,1} is constant\n"
               "\n"
               "Path-connected: ‚àÄx, y ‚àà X, ‚àÉ continuous path Œ≥: [0,1] ‚Üí X\n"
               "  with Œ≥(0) = x, Œ≥(1) = y\n"
               "\n"
               "Theorem: Path-connected ‚áí Connected\n"
               "(converse false: topologist's sine curve)\n"
               "\n"
               "Intermediate Value Theorem: If f: X ‚Üí ‚Ñù continuous\n"
               "and X connected, then f(X) is an interval.";
    }

    /**
     * @brief Bases and subbases
     */
    static std::string basesSubbases() {
        return "Bases and Subbases:\n"
               "\n"
               "Base: Collection ùìë of open sets such that every open set\n"
               "  is a union of sets from ùìë\n"
               "\n"
               "Conditions for ùìë to be a base:\n"
               "1. ‚ãÉùìë = X (cover X)\n"
               "2. For B‚ÇÅ, B‚ÇÇ ‚àà ùìë and x ‚àà B‚ÇÅ ‚à© B‚ÇÇ,\n"
               "   ‚àÉB‚ÇÉ ‚àà ùìë: x ‚àà B‚ÇÉ ‚äÜ B‚ÇÅ ‚à© B‚ÇÇ\n"
               "\n"
               "Example: Open balls form base for metric topology\n"
               "\n"
               "Subbase: Collection ùì¢ such that finite intersections\n"
               "  of sets from ùì¢ form a base\n"
               "\n"
               "Any collection ùì¢ can be made into a subbase by declaring\n"
               "it generates the coarsest topology containing ùì¢.";
    }
};

/**
 * @class WeakTopology
 * @brief Weak topologies and weak* topologies
 */
class WeakTopology {
public:
    /**
     * @brief Initial topology / weak topology
     */
    static std::string initialTopology() {
        return "Initial/Weak Topology:\n"
               "\n"
               "Given: X set, {(Y·µ¢, œÑ·µ¢)}·µ¢‚ààI topological spaces,\n"
               "       functions f·µ¢: X ‚Üí Y·µ¢\n"
               "\n"
               "The initial topology on X (induced by {f·µ¢}) is the\n"
               "coarsest topology making all f·µ¢ continuous.\n"
               "\n"
               "Subbase: {f·µ¢‚Åª¬π(U) : i ‚àà I, U open in Y·µ¢}\n"
               "\n"
               "Universal property: g: Z ‚Üí X continuous ‚ü∫\n"
               "  f·µ¢ ‚àò g: Z ‚Üí Y·µ¢ continuous for all i\n"
               "\n"
               "Examples:\n"
               "- Subspace topology: Y ‚äÜ X, f: Y ‚Üí X inclusion\n"
               "- Product topology: X = ‚àèX·µ¢, œÄ·µ¢: X ‚Üí X·µ¢ projections\n"
               "- Weak topology on normed space: induced by\n"
               "  continuous linear functionals";
    }

    /**
     * @brief Final topology / quotient topology
     */
    static std::string finalTopology() {
        return "Final/Quotient Topology:\n"
               "\n"
               "Given: X set, {(Y·µ¢, œÑ·µ¢)}·µ¢‚ààI topological spaces,\n"
               "       functions f·µ¢: Y·µ¢ ‚Üí X\n"
               "\n"
               "The final topology on X is the finest topology\n"
               "making all f·µ¢ continuous.\n"
               "\n"
               "U ‚äÜ X open ‚ü∫ f·µ¢‚Åª¬π(U) open in Y·µ¢ for all i\n"
               "\n"
               "Universal property: g: X ‚Üí Z continuous ‚ü∫\n"
               "  g ‚àò f·µ¢: Y·µ¢ ‚Üí Z continuous for all i\n"
               "\n"
               "Examples:\n"
               "- Quotient topology: X/~ with œÄ: X ‚Üí X/~\n"
               "- Coproduct (disjoint union) topology";
    }

    /**
     * @brief Weak topology on Banach spaces
     */
    static std::string weakTopologyBanach() {
        return "Weak Topology on Banach Spaces:\n"
               "\n"
               "For Banach space X with dual X*, the weak topology œÉ(X, X*)\n"
               "is the coarsest topology making all f ‚àà X* continuous.\n"
               "\n"
               "Subbase: {f‚Åª¬π(U) : f ‚àà X*, U open in ‚Ñù}\n"
               "\n"
               "Convergence: x‚Çô ‚áÄ x (weak) ‚ü∫ f(x‚Çô) ‚Üí f(x) ‚àÄf ‚àà X*\n"
               "\n"
               "Properties:\n"
               "- Weaker than norm topology (fewer open sets)\n"
               "- Bounded sets in weak topology = bounded in norm\n"
               "- Closed convex sets: weak closure = norm closure\n"
               "- Sequential compactness: reflexive spaces have\n"
               "  bounded sequences with weakly convergent subsequences\n"
               "\n"
               "Weak* topology œÉ(X*, X) on X*:\n"
               "- Induced by evaluation maps œÜ‚Çì: X* ‚Üí ‚Ñù, f ‚Ü¶ f(x)\n"
               "- f‚Çô ‚áÄ* f ‚ü∫ f‚Çô(x) ‚Üí f(x) ‚àÄx ‚àà X\n"
               "- Banach-Alaoglu: Closed unit ball in X* is\n"
               "  weak* compact";
    }
};

/**
 * @class Semicontinuity
 * @brief Lower and upper semicontinuous functions
 */
class Semicontinuity {
public:
    /**
     * @brief Lower semicontinuity
     */
    static std::string lowerSemicontinuous() {
        return "Lower Semicontinuous Functions:\n"
               "\n"
               "f: X ‚Üí ‚Ñù ‚à™ {+‚àû} is lower semicontinuous (lsc) at x‚ÇÄ if:\n"
               "  lim inf_{x‚Üíx‚ÇÄ} f(x) ‚â• f(x‚ÇÄ)\n"
               "\n"
               "Equivalently:\n"
               "1. ‚àÄŒ± ‚àà ‚Ñù, {x : f(x) > Œ±} is open (sublevel sets open)\n"
               "2. ‚àÄx‚Çô ‚Üí x‚ÇÄ, lim inf f(x‚Çô) ‚â• f(x‚ÇÄ)\n"
               "3. epigraph epi(f) = {(x,t) : f(x) ‚â§ t} is closed\n"
               "\n"
               "Properties:\n"
               "- Supremum of lsc functions is lsc\n"
               "- Sum of lsc functions is lsc (if defined)\n"
               "- lsc function on compact set attains minimum\n"
               "\n"
               "Example: indicator function I_C(x) = 0 if x ‚àà C,\n"
               "  +‚àû otherwise, is lsc ‚ü∫ C is closed";
    }

    /**
     * @brief Upper semicontinuity
     */
    static std::string upperSemicontinuous() {
        return "Upper Semicontinuous Functions:\n"
               "\n"
               "f: X ‚Üí ‚Ñù ‚à™ {-‚àû} is upper semicontinuous (usc) at x‚ÇÄ if:\n"
               "  lim sup_{x‚Üíx‚ÇÄ} f(x) ‚â§ f(x‚ÇÄ)\n"
               "\n"
               "Equivalently:\n"
               "1. ‚àÄŒ± ‚àà ‚Ñù, {x : f(x) < Œ±} is open\n"
               "2. -f is lower semicontinuous\n"
               "3. hypograph hypo(f) = {(x,t) : f(x) ‚â• t} is closed\n"
               "\n"
               "Properties:\n"
               "- Infimum of usc functions is usc\n"
               "- usc function on compact set attains maximum\n"
               "\n"
               "Theorem: f continuous ‚ü∫ f both lsc and usc\n"
               "\n"
               "Application (Weierstrass Theorem): Continuous function\n"
               "on non-empty compact set attains max and min.";
    }

    /**
     * @brief Existence theorems via semicontinuity
     */
    static std::string existenceResults() {
        return "Existence Results via Semicontinuity:\n"
               "\n"
               "Theorem 1 (Minimum): If f: X ‚Üí ‚Ñù ‚à™ {+‚àû} is lsc\n"
               "and K ‚äÜ X is non-empty, compact, then:\n"
               "  inf_{x ‚àà K} f(x) is attained (if finite)\n"
               "\n"
               "Theorem 2 (Maximum): If f: X ‚Üí ‚Ñù ‚à™ {-‚àû} is usc\n"
               "and K ‚äÜ X is non-empty, compact, then:\n"
               "  sup_{x ‚àà K} f(x) is attained (if finite)\n"
               "\n"
               "Corollary (Weierstrass): Continuous function on\n"
               "non-empty compact set attains its bounds.\n"
               "\n"
               "Application: Many optimization problems can be solved\n"
               "by showing objective is lsc and constraint set is compact.\n"
               "\n"
               "Relaxation: If minimization problem has no solution,\n"
               "replace f with lsc envelope (largest lsc function ‚â§ f).";
    }
};

/**
 * @class BaireSpaces
 * @brief Baire category theorem and applications
 */
class BaireSpaces {
public:
    /**
     * @brief Baire Category Theorem
     */
    static std::string categoryTheorem() {
        return "Baire Category Theorem:\n"
               "\n"
               "In a complete metric space (or locally compact Hausdorff),\n"
               "the intersection of countably many dense open sets is dense.\n"
               "\n"
               "Equivalently: Complete metric space cannot be written\n"
               "as countable union of nowhere dense sets.\n"
               "\n"
               "Definitions:\n"
               "- Dense: cl(A) = X\n"
               "- Nowhere dense: int(cl(A)) = ‚àÖ\n"
               "- Meager (first category): countable union of nowhere dense\n"
               "- Comeager/residual (second category): complement is meager\n"
               "\n"
               "Baire space: non-empty open set is not meager\n"
               "(equivalently: BCT holds)\n"
               "\n"
               "Examples: ‚Ñù‚Åø, C[0,1], L·µñ spaces are Baire.";
    }

    /**
     * @brief Uniform Boundedness Theorem
     */
    static std::string uniformBoundedness() {
        return "Uniform Boundedness Theorem (Banach-Steinhaus):\n"
               "\n"
               "Let X be Banach space, Y normed space,\n"
               "and {T·µ¢}·µ¢‚ààI family of continuous linear operators T·µ¢: X ‚Üí Y.\n"
               "\n"
               "If ‚àÄx ‚àà X, sup_{i‚ààI} ‚ÄñT·µ¢(x)‚Äñ < ‚àû (pointwise bounded),\n"
               "then sup_{i‚ààI} ‚ÄñT·µ¢‚Äñ < ‚àû (uniformly bounded).\n"
               "\n"
               "Proof uses Baire Category Theorem!\n"
               "\n"
               "Consequences:\n"
               "1. If T‚Çô(x) converges for all x, then {‚ÄñT‚Çô‚Äñ} is bounded\n"
               "\n"
               "2. There exists continuous function f with Fourier series\n"
               "   diverging at a point\n"
               "\n"
               "3. Strong convergence of {T‚Çô} (operator norm) is stronger\n"
               "   than weak convergence (pointwise)";
    }

    /**
     * @brief Open Mapping Theorem
     */
    static std::string openMappingTheorem() {
        return "Open Mapping Theorem (Banach-Schauder):\n"
               "\n"
               "If T: X ‚Üí Y is surjective continuous linear operator\n"
               "between Banach spaces, then T is an open mapping\n"
               "(maps open sets to open sets).\n"
               "\n"
               "Consequences:\n"
               "\n"
               "1. Inverse Mapping Theorem: If T: X ‚Üí Y bijective\n"
               "   continuous linear between Banach spaces,\n"
               "   then T‚Åª¬π is continuous (i.e., T is homeomorphism)\n"
               "\n"
               "2. Closed Graph Theorem: T: X ‚Üí Y linear between\n"
               "   Banach spaces is continuous ‚ü∫ graph is closed\n"
               "\n"
               "All three theorems (UBT, OMT, CGT) are equivalent\n"
               "and rely on Baire Category Theorem.\n"
               "\n"
               "Application: Two norms ‚Äñ¬∑‚Äñ‚ÇÅ, ‚Äñ¬∑‚Äñ‚ÇÇ on Banach space\n"
               "are equivalent ‚ü∫ they induce same topology.";
    }
};

} // namespace maths::topology

#endif // MATHS_TOPOLOGY_TOPOLOGICAL_SPACES_HPP
